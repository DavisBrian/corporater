<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Modern R in a Corporate Environment</title>
  <meta name="description" content="This is an original course for RADARS">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Modern R in a Corporate Environment" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an original course for RADARS" />
  <meta name="github-repo" content="DavisBrian/corporater" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Modern R in a Corporate Environment" />
  
  <meta name="twitter:description" content="This is an original course for RADARS" />
  

<meta name="author" content="Brian Davis">


<meta name="date" content="2018-08-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="tidy-data.html">
<link rel="next" href="appendix-resources.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern R in a Corporate Environment</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Preamble</b></span></li>
<li class="chapter" data-level="1" data-path="preamble-intro.html"><a href="preamble-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="preamble-intro.html"><a href="preamble-intro.html#course-philosophy"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy</a><ul>
<li class="chapter" data-level="1.1.1" data-path="preamble-intro.html"><a href="preamble-intro.html#reproducible-research-approach"><i class="fa fa-check"></i><b>1.1.1</b> Reproducible Research Approach</a></li>
<li class="chapter" data-level="1.1.2" data-path="preamble-intro.html"><a href="preamble-intro.html#fda-validation"><i class="fa fa-check"></i><b>1.1.2</b> FDA Validation</a></li>
<li class="chapter" data-level="1.1.3" data-path="preamble-intro.html"><a href="preamble-intro.html#the-sas-myth"><i class="fa fa-check"></i><b>1.1.3</b> The SAS Myth</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="preamble-intro.html"><a href="preamble-intro.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="preamble-intro.html"><a href="preamble-intro.html#content"><i class="fa fa-check"></i><b>1.3</b> Content</a></li>
<li class="chapter" data-level="1.4" data-path="preamble-intro.html"><a href="preamble-intro.html#structure"><i class="fa fa-check"></i><b>1.4</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>2</b> Good practices</a><ul>
<li class="chapter" data-level="2.1" data-path="good-practices.html"><a href="good-practices.html#coding-style"><i class="fa fa-check"></i><b>2.1</b> Coding style</a><ul>
<li class="chapter" data-level="2.1.1" data-path="good-practices.html"><a href="good-practices.html#comments"><i class="fa fa-check"></i><b>2.1.1</b> Comments</a></li>
<li class="chapter" data-level="2.1.2" data-path="good-practices.html"><a href="good-practices.html#naming"><i class="fa fa-check"></i><b>2.1.2</b> Naming</a></li>
<li class="chapter" data-level="2.1.3" data-path="good-practices.html"><a href="good-practices.html#spacing"><i class="fa fa-check"></i><b>2.1.3</b> Spacing</a></li>
<li class="chapter" data-level="2.1.4" data-path="good-practices.html"><a href="good-practices.html#indenting"><i class="fa fa-check"></i><b>2.1.4</b> Indenting</a></li>
<li class="chapter" data-level="2.1.5" data-path="good-practices.html"><a href="good-practices.html#long-lines"><i class="fa fa-check"></i><b>2.1.5</b> Long lines</a></li>
<li class="chapter" data-level="2.1.6" data-path="good-practices.html"><a href="good-practices.html#other"><i class="fa fa-check"></i><b>2.1.6</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="good-practices.html"><a href="good-practices.html#coding-practices"><i class="fa fa-check"></i><b>2.2</b> Coding practices</a><ul>
<li class="chapter" data-level="2.2.1" data-path="good-practices.html"><a href="good-practices.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="good-practices.html"><a href="good-practices.html#rule-of-threedry"><i class="fa fa-check"></i><b>2.2.2</b> <em>Rule of Three</em></a></li>
<li class="chapter" data-level="2.2.3" data-path="good-practices.html"><a href="good-practices.html#path-names"><i class="fa fa-check"></i><b>2.2.3</b> Path names</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="good-practices.html"><a href="good-practices.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="good-practices.html"><a href="good-practices.html#getting-help"><i class="fa fa-check"></i><b>2.4</b> Getting help</a><ul>
<li class="chapter" data-level="2.4.1" data-path="good-practices.html"><a href="good-practices.html#help-yourself-learn-how-to-debug"><i class="fa fa-check"></i><b>2.4.1</b> Help yourself, learn how to debug</a></li>
<li class="chapter" data-level="2.4.2" data-path="good-practices.html"><a href="good-practices.html#external-help"><i class="fa fa-check"></i><b>2.4.2</b> External help</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="good-practices.html"><a href="good-practices.html#keeping-up-to-date"><i class="fa fa-check"></i><b>2.5</b> Keeping up to date</a></li>
<li class="chapter" data-level="2.6" data-path="good-practices.html"><a href="good-practices.html#exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Base R Basics</b></span></li>
<li class="chapter" data-level="3" data-path="baser-rbasics.html"><a href="baser-rbasics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#assignment-operators"><i class="fa fa-check"></i><b>3.1</b> Assignment Operators</a></li>
<li class="chapter" data-level="3.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#objects"><i class="fa fa-check"></i><b>3.2</b> Objects</a><ul>
<li class="chapter" data-level="3.2.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#vector"><i class="fa fa-check"></i><b>3.2.1</b> Vector</a></li>
<li class="chapter" data-level="3.2.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#matrix"><i class="fa fa-check"></i><b>3.2.2</b> Matrix</a></li>
<li class="chapter" data-level="3.2.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#list"><i class="fa fa-check"></i><b>3.2.3</b> List</a></li>
<li class="chapter" data-level="3.2.4" data-path="baser-rbasics.html"><a href="baser-rbasics.html#data-frame"><i class="fa fa-check"></i><b>3.2.4</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#comparision"><i class="fa fa-check"></i><b>3.3</b> Comparision</a></li>
<li class="chapter" data-level="3.4" data-path="baser-rbasics.html"><a href="baser-rbasics.html#logical-and-sets"><i class="fa fa-check"></i><b>3.4</b> Logical and sets</a></li>
<li class="chapter" data-level="3.5" data-path="baser-rbasics.html"><a href="baser-rbasics.html#control-structures"><i class="fa fa-check"></i><b>3.5</b> Control Structures</a><ul>
<li class="chapter" data-level="3.5.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#if-else"><i class="fa fa-check"></i><b>3.5.1</b> <code>if</code>-<code>else</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#for-loops"><i class="fa fa-check"></i><b>3.5.2</b> <code>for</code> Loops</a></li>
<li class="chapter" data-level="3.5.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#while-loops"><i class="fa fa-check"></i><b>3.5.3</b> <code>while</code> Loops</a></li>
<li class="chapter" data-level="3.5.4" data-path="baser-rbasics.html"><a href="baser-rbasics.html#repeat-loops"><i class="fa fa-check"></i><b>3.5.4</b> <code>repeat</code> Loops</a></li>
<li class="chapter" data-level="3.5.5" data-path="baser-rbasics.html"><a href="baser-rbasics.html#next-break"><i class="fa fa-check"></i><b>3.5.5</b> <code>next</code>, <code>break</code></a></li>
<li class="chapter" data-level="3.5.6" data-path="baser-rbasics.html"><a href="baser-rbasics.html#looping"><i class="fa fa-check"></i><b>3.5.6</b> Looping</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="baser-rbasics.html"><a href="baser-rbasics.html#vectorization-recycling"><i class="fa fa-check"></i><b>3.6</b> Vectorization &amp; Recycling</a><ul>
<li class="chapter" data-level="3.6.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#example"><i class="fa fa-check"></i><b>3.6.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="baser-rbasics.html"><a href="baser-rbasics.html#function-basics"><i class="fa fa-check"></i><b>3.7</b> Function Basics</a><ul>
<li class="chapter" data-level="3.7.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#your-first-function"><i class="fa fa-check"></i><b>3.7.1</b> Your First Function</a></li>
<li class="chapter" data-level="3.7.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#lazy-evaluation"><i class="fa fa-check"></i><b>3.7.2</b> Lazy Evaluation</a></li>
<li class="chapter" data-level="3.7.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#the-...-argument"><i class="fa fa-check"></i><b>3.7.3</b> The <code>...</code> Argument</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="baser-rbasics.html"><a href="baser-rbasics.html#environments-scoping"><i class="fa fa-check"></i><b>3.8</b> Environments &amp; Scoping</a></li>
<li class="chapter" data-level="3.9" data-path="baser-rbasics.html"><a href="baser-rbasics.html#exercises-1"><i class="fa fa-check"></i><b>3.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html"><i class="fa fa-check"></i><b>4</b> Base R Data Structures</a><ul>
<li class="chapter" data-level="4.1" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#naming-rules"><i class="fa fa-check"></i><b>4.1</b> Naming Rules</a></li>
<li class="chapter" data-level="4.2" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#vectors"><i class="fa fa-check"></i><b>4.2</b> Vectors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#atomic-vectors"><i class="fa fa-check"></i><b>4.2.1</b> Atomic Vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#lists"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#null"><i class="fa fa-check"></i><b>4.2.3</b> <code>NULL</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#attributes"><i class="fa fa-check"></i><b>4.2.4</b> Attributes</a></li>
<li class="chapter" data-level="4.2.5" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#factors"><i class="fa fa-check"></i><b>4.2.5</b> Factors</a></li>
<li class="chapter" data-level="4.2.6" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#matrices-and-arrays"><i class="fa fa-check"></i><b>4.2.6</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.7" data-path="base-r-data-structures.html"><a href="base-r-data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.2.7</b> Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>5</b> Subsetting</a><ul>
<li class="chapter" data-level="5.1" data-path="subsetting.html"><a href="subsetting.html#selecting-multiple-elements"><i class="fa fa-check"></i><b>5.1</b> Selecting multiple elements</a><ul>
<li class="chapter" data-level="5.1.1" data-path="subsetting.html"><a href="subsetting.html#atomic-vectors-1"><i class="fa fa-check"></i><b>5.1.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="5.1.2" data-path="subsetting.html"><a href="subsetting.html#matrices-and-arrays-1"><i class="fa fa-check"></i><b>5.1.2</b> Matrices and Arrays</a></li>
<li class="chapter" data-level="5.1.3" data-path="subsetting.html"><a href="subsetting.html#lists-1"><i class="fa fa-check"></i><b>5.1.3</b> Lists</a></li>
<li class="chapter" data-level="5.1.4" data-path="subsetting.html"><a href="subsetting.html#data-frames-1"><i class="fa fa-check"></i><b>5.1.4</b> Data Frames</a></li>
<li class="chapter" data-level="5.1.5" data-path="subsetting.html"><a href="subsetting.html#preserving-dimensionality"><i class="fa fa-check"></i><b>5.1.5</b> Preserving dimensionality</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="subsetting.html"><a href="subsetting.html#selecting-a-single-elements"><i class="fa fa-check"></i><b>5.2</b> Selecting a single elements</a><ul>
<li class="chapter" data-level="5.2.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>5.2.1</b> <code>$</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="subsetting.html"><a href="subsetting.html#missingout-of-bounds-indices"><i class="fa fa-check"></i><b>5.2.2</b> Missing/out of bounds indices</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>5.3</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="5.4" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>5.4</b> Applications</a><ul>
<li class="chapter" data-level="5.4.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables-character-subsetting"><i class="fa fa-check"></i><b>5.4.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="5.4.2" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>5.4.2</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="5.4.3" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>5.4.3</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="5.4.4" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character-subsetting"><i class="fa fa-check"></i><b>5.4.4</b> Removing columns from data frames (character subsetting)</a></li>
<li class="chapter" data-level="5.4.5" data-path="subsetting.html"><a href="subsetting.html#random-samplesbootstrap-integer-subsetting"><i class="fa fa-check"></i><b>5.4.5</b> Random samples/bootstrap (integer subsetting)</a></li>
<li class="chapter" data-level="5.4.6" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-vs.sets-logical-integer-subsetting"><i class="fa fa-check"></i><b>5.4.6</b> Boolean algebra vs. sets (logical &amp; integer subsetting)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="subsetting.html"><a href="subsetting.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III R4DS</b></span></li>
<li class="chapter" data-level="6" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>6</b> Data Visualization</a><ul>
<li class="chapter" data-level="6.1" data-path="data-visualization.html"><a href="data-visualization.html#why-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Why ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="data-visualization.html"><a href="data-visualization.html#example-1"><i class="fa fa-check"></i><b>6.2</b> Example</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-visualization.html"><a href="data-visualization.html#data"><i class="fa fa-check"></i><b>6.2.1</b> Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-visualization.html"><a href="data-visualization.html#aesthetics"><i class="fa fa-check"></i><b>6.2.2</b> Aesthetics</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-visualization.html"><a href="data-visualization.html#geoms"><i class="fa fa-check"></i><b>6.2.3</b> Geoms</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-visualization.html"><a href="data-visualization.html#scales"><i class="fa fa-check"></i><b>6.2.4</b> Scales</a></li>
<li class="chapter" data-level="6.2.5" data-path="data-visualization.html"><a href="data-visualization.html#themes"><i class="fa fa-check"></i><b>6.2.5</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-visualization.html"><a href="data-visualization.html#facets"><i class="fa fa-check"></i><b>6.3</b> Facets</a></li>
<li class="chapter" data-level="6.4" data-path="data-visualization.html"><a href="data-visualization.html#stats"><i class="fa fa-check"></i><b>6.4</b> Stats</a></li>
<li class="chapter" data-level="6.5" data-path="data-visualization.html"><a href="data-visualization.html#saving"><i class="fa fa-check"></i><b>6.5</b> Saving</a></li>
<li class="chapter" data-level="6.6" data-path="data-visualization.html"><a href="data-visualization.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
<li class="chapter" data-level="6.7" data-path="data-visualization.html"><a href="data-visualization.html#resources-and-links"><i class="fa fa-check"></i><b>6.7</b> Resources and Links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>7</b> Data Transformation</a><ul>
<li class="chapter" data-level="7.1" data-path="data-transformation.html"><a href="data-transformation.html#tibbles"><i class="fa fa-check"></i><b>7.1</b> Tibbles</a></li>
<li class="chapter" data-level="7.2" data-path="data-transformation.html"><a href="data-transformation.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>7.2</b> Filter rows with <code>filter()</code></a></li>
<li class="chapter" data-level="7.3" data-path="data-transformation.html"><a href="data-transformation.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>7.3</b> Arrange rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="7.4" data-path="data-transformation.html"><a href="data-transformation.html#select-columns-with-select"><i class="fa fa-check"></i><b>7.4</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="7.5" data-path="data-transformation.html"><a href="data-transformation.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>7.5</b> Add new variables with <code>mutate()</code></a></li>
<li class="chapter" data-level="7.6" data-path="data-transformation.html"><a href="data-transformation.html#pipes"><i class="fa fa-check"></i><b>7.6</b> Pipes</a><ul>
<li class="chapter" data-level="7.6.1" data-path="data-transformation.html"><a href="data-transformation.html#intermediate-steps"><i class="fa fa-check"></i><b>7.6.1</b> Intermediate steps</a></li>
<li class="chapter" data-level="7.6.2" data-path="data-transformation.html"><a href="data-transformation.html#overwrite-the-original"><i class="fa fa-check"></i><b>7.6.2</b> Overwrite the original</a></li>
<li class="chapter" data-level="7.6.3" data-path="data-transformation.html"><a href="data-transformation.html#function-composition"><i class="fa fa-check"></i><b>7.6.3</b> Function composition</a></li>
<li class="chapter" data-level="7.6.4" data-path="data-transformation.html"><a href="data-transformation.html#use-the-pipe-operator"><i class="fa fa-check"></i><b>7.6.4</b> Use the pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="data-transformation.html"><a href="data-transformation.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>7.7</b> Grouped summaries with <code>summarise()</code></a></li>
<li class="chapter" data-level="7.8" data-path="data-transformation.html"><a href="data-transformation.html#grouped-mutates"><i class="fa fa-check"></i><b>7.8</b> Grouped mutates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>8</b> Data Import</a><ul>
<li class="chapter" data-level="8.1" data-path="data-import.html"><a href="data-import.html#text-files"><i class="fa fa-check"></i><b>8.1</b> Text Files</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data-import.html"><a href="data-import.html#readr"><i class="fa fa-check"></i><b>8.1.1</b> readr</a></li>
<li class="chapter" data-level="8.1.2" data-path="data-import.html"><a href="data-import.html#base-r"><i class="fa fa-check"></i><b>8.1.2</b> base R</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-import.html"><a href="data-import.html#sas-files"><i class="fa fa-check"></i><b>8.2</b> SAS Files</a></li>
<li class="chapter" data-level="8.3" data-path="data-import.html"><a href="data-import.html#excel"><i class="fa fa-check"></i><b>8.3</b> Excel</a></li>
<li class="chapter" data-level="8.4" data-path="data-import.html"><a href="data-import.html#databases"><i class="fa fa-check"></i><b>8.4</b> Databases</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>9</b> Strings</a><ul>
<li class="chapter" data-level="9.1" data-path="strings.html"><a href="strings.html#basics"><i class="fa fa-check"></i><b>9.1</b> Basics</a><ul>
<li class="chapter" data-level="9.1.1" data-path="strings.html"><a href="strings.html#helpful-basic-string-functions"><i class="fa fa-check"></i><b>9.1.1</b> Helpful Basic String Functions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="strings.html"><a href="strings.html#regular-expressions"><i class="fa fa-check"></i><b>9.2</b> Regular Expressions</a><ul>
<li class="chapter" data-level="9.2.1" data-path="strings.html"><a href="strings.html#basic-matches"><i class="fa fa-check"></i><b>9.2.1</b> Basic Matches</a></li>
<li class="chapter" data-level="9.2.2" data-path="strings.html"><a href="strings.html#special-characters"><i class="fa fa-check"></i><b>9.2.2</b> Special Characters</a></li>
<li class="chapter" data-level="9.2.3" data-path="strings.html"><a href="strings.html#character-classes-and-alternatives"><i class="fa fa-check"></i><b>9.2.3</b> Character Classes and Alternatives</a></li>
<li class="chapter" data-level="9.2.4" data-path="strings.html"><a href="strings.html#repetition"><i class="fa fa-check"></i><b>9.2.4</b> Repetition</a></li>
<li class="chapter" data-level="9.2.5" data-path="strings.html"><a href="strings.html#grouping"><i class="fa fa-check"></i><b>9.2.5</b> Grouping</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="strings.html"><a href="strings.html#helpful-string-functions"><i class="fa fa-check"></i><b>9.3</b> Helpful String Functions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="strings.html"><a href="strings.html#detect-matches"><i class="fa fa-check"></i><b>9.3.1</b> Detect Matches</a></li>
<li class="chapter" data-level="9.3.2" data-path="strings.html"><a href="strings.html#extract-matches"><i class="fa fa-check"></i><b>9.3.2</b> Extract Matches</a></li>
<li class="chapter" data-level="9.3.3" data-path="strings.html"><a href="strings.html#replacing-matches"><i class="fa fa-check"></i><b>9.3.3</b> Replacing Matches</a></li>
<li class="chapter" data-level="9.3.4" data-path="strings.html"><a href="strings.html#other-string-functions"><i class="fa fa-check"></i><b>9.3.4</b> Other String Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>10</b> Tidy Data</a><ul>
<li class="chapter" data-level="10.1" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>10.1</b> Tidy data</a></li>
<li class="chapter" data-level="10.2" data-path="tidy-data.html"><a href="tidy-data.html#example-2"><i class="fa fa-check"></i><b>10.2</b> Example</a></li>
<li class="chapter" data-level="10.3" data-path="tidy-data.html"><a href="tidy-data.html#spreading-and-gathering"><i class="fa fa-check"></i><b>10.3</b> Spreading and gathering</a><ul>
<li class="chapter" data-level="10.3.1" data-path="tidy-data.html"><a href="tidy-data.html#gathering"><i class="fa fa-check"></i><b>10.3.1</b> Gathering</a></li>
<li class="chapter" data-level="10.3.2" data-path="tidy-data.html"><a href="tidy-data.html#spreading"><i class="fa fa-check"></i><b>10.3.2</b> Spreading</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tidy-data.html"><a href="tidy-data.html#separating-and-uniting"><i class="fa fa-check"></i><b>10.4</b> Separating and uniting</a><ul>
<li class="chapter" data-level="10.4.1" data-path="tidy-data.html"><a href="tidy-data.html#separate"><i class="fa fa-check"></i><b>10.4.1</b> Separate</a></li>
<li class="chapter" data-level="10.4.2" data-path="tidy-data.html"><a href="tidy-data.html#unite"><i class="fa fa-check"></i><b>10.4.2</b> Unite</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="tidy-data.html"><a href="tidy-data.html#missing-values"><i class="fa fa-check"></i><b>10.5</b> Missing values</a></li>
<li class="chapter" data-level="10.6" data-path="tidy-data.html"><a href="tidy-data.html#non-tidy-data"><i class="fa fa-check"></i><b>10.6</b> Non-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>11</b> Relational Data</a><ul>
<li class="chapter" data-level="11.1" data-path="relational-data.html"><a href="relational-data.html#mutating-joins"><i class="fa fa-check"></i><b>11.1</b> Mutating Joins</a><ul>
<li class="chapter" data-level="11.1.1" data-path="relational-data.html"><a href="relational-data.html#duplicate-keys"><i class="fa fa-check"></i><b>11.1.1</b> Duplicate keys</a></li>
<li class="chapter" data-level="11.1.2" data-path="relational-data.html"><a href="relational-data.html#multi-column-keys"><i class="fa fa-check"></i><b>11.1.2</b> Multi-Column Keys</a></li>
<li class="chapter" data-level="11.1.3" data-path="relational-data.html"><a href="relational-data.html#duplicate-non-key-columns"><i class="fa fa-check"></i><b>11.1.3</b> Duplicate Non-Key Columns</a></li>
<li class="chapter" data-level="11.1.4" data-path="relational-data.html"><a href="relational-data.html#different-key-column-names"><i class="fa fa-check"></i><b>11.1.4</b> Different Key Column Names</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="relational-data.html"><a href="relational-data.html#filtering-joins"><i class="fa fa-check"></i><b>11.2</b> Filtering Joins</a></li>
<li class="chapter" data-level="11.3" data-path="relational-data.html"><a href="relational-data.html#set-operations"><i class="fa fa-check"></i><b>11.3</b> Set Operations</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="12" data-path="appendix-resources.html"><a href="appendix-resources.html"><i class="fa fa-check"></i><b>12</b> Appendix A</a><ul>
<li class="chapter" data-level="12.1" data-path="appendix-resources.html"><a href="appendix-resources.html#e-books"><i class="fa fa-check"></i><b>12.1</b> E-Books</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern R in a Corporate Environment</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relational-data" class="section level1">
<h1><span class="header-section-number">11</span> Relational Data</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>Data analysis rarely involves only a single table of data. Typically you have multiple tables of data, when combined, answer the questions at hand. Collectively, multiple tables of data are called <strong>relational data</strong> because it is the relations, not just the individual datasets, that are important. Relations are <strong>always</strong> defined between a pair of tables. All other relations are built up from this simple idea. A <strong>key</strong> is a variable, or set of variables, that uniquely identifies an observation and links tables together.</p>
<p>To work with relational data you need verbs that work with pairs of tables. There are three families of verbs designed to work with relational data:</p>
<ul>
<li><p><strong>Mutating joins</strong>, which add new variables to one data frame from matching observations in another.</p></li>
<li><p><strong>Filtering joins</strong>, which filter observations from one data frame based on whether or not they match an observation in the other table.</p></li>
<li><p><strong>Set operations</strong>, which treat observations as if they were set elements.</p></li>
</ul>
<p>The most common place to find relational data is in a <em>relational</em> database management system (or RDBMS), a term that encompasses almost all modern databases. If you’ve used a database before, you’ve almost certainly used SQL. A <strong>key</strong> is a variable, or set of variables, that uniquely identifies an observation.</p>
<p><img src="images/relational/join-setup.png" width="118" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;     key val_x</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1   </span>
<span class="co">#&gt; 2     2 x2   </span>
<span class="co">#&gt; 3     3 x3</span>
y
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;     key val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 y1   </span>
<span class="co">#&gt; 2     2 y2   </span>
<span class="co">#&gt; 3     4 y3</span></code></pre></div>
<div id="mutating-joins" class="section level2">
<h2><span class="header-section-number">11.1</span> Mutating Joins</h2>
<p>A mutating join allows you to combine variables from two tables. It first matches observations by their keys, then copies across variables from one table to the other. Like mutate(), the join functions add variables to the right, so if you have a lot of variables already, the new variables won’t get printed out.</p>
<p><strong>Inner Joins</strong></p>
<ul>
<li><strong>inner join</strong> keeps all observations in common between x and y</li>
</ul>
<p><img src="images/relational/join-inner.png" width="338" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inner_join</span>(x, y)
<span class="co">#&gt; Joining, by = &quot;key&quot;</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;     key val_x val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1    y1   </span>
<span class="co">#&gt; 2     2 x2    y2</span></code></pre></div>

<div class="rmdtip">
By default the <strong>join</strong> functions will use all variables in common as the key. Best practice is to explicitly state the variables you wish to join by using the <code>by</code> parameter.
</div>

<p><strong>Outer Joins</strong></p>
<ul>
<li><strong>left join</strong> keeps all observations in x append columns from y</li>
<li><strong>right join</strong> keeps all observations in y append columns from x</li>
<li><strong>full join</strong> keeps all observations in x and y</li>
</ul>
<p><img src="images/relational/join-outer.png" width="355" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;     key val_x val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1    y1   </span>
<span class="co">#&gt; 2     2 x2    y2   </span>
<span class="co">#&gt; 3     3 x3    &lt;NA&gt;</span>
<span class="kw">right_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;     key val_x val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1    y1   </span>
<span class="co">#&gt; 2     2 x2    y2   </span>
<span class="co">#&gt; 3     4 &lt;NA&gt;  y3</span>
<span class="kw">full_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;     key val_x val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1    y1   </span>
<span class="co">#&gt; 2     2 x2    y2   </span>
<span class="co">#&gt; 3     3 x3    &lt;NA&gt; </span>
<span class="co">#&gt; 4     4 &lt;NA&gt;  y3</span></code></pre></div>
<div class="rmdnote">
<p>
<strong>left_join</strong> and <strong>right_join</strong> are interchangeable with the arguments reversed. The only difference is the order of the columns in the resulting data frame.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(x, y, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;     key val_x val_y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 x1    y1   </span>
<span class="co">#&gt; 2     2 x2    y2   </span>
<span class="co">#&gt; 3     3 x3    &lt;NA&gt;</span>
<span class="kw">right_join</span>(y, x, <span class="dt">by =</span> <span class="st">&quot;key&quot;</span>)
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;     key val_y val_x</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 y1    x1   </span>
<span class="co">#&gt; 2     2 y2    x2   </span>
<span class="co">#&gt; 3     3 &lt;NA&gt;  x3</span></code></pre></div>
<div id="duplicate-keys" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Duplicate keys</h3>
<p>There are many cases where a single key does not uniquely identify an observation.</p>
<p><strong>One-to-Many</strong> <img src="images/relational/join-one-to-many.png" width="279" style="display: block; margin: auto;" /></p>
<p><strong>Many-to-Many</strong> <img src="images/relational/join-many-to-many.png" width="342" style="display: block; margin: auto;" /></p>
</div>
<div id="multi-column-keys" class="section level3">
<h3><span class="header-section-number">11.1.2</span> Multi-Column Keys</h3>
<p>By default all variables that are in both tables. To specify a subset of variables for the key use the <code>by</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yq, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Yes&quot;</span>
)

y &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yq, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method1&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">4</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Method1&quot;</span>
)

<span class="co"># full</span>
<span class="kw">full_join</span>(x, y)                          <span class="co"># probably not what we want</span>
<span class="co">#&gt; Joining, by = c(&quot;id&quot;, &quot;yq&quot;, &quot;question&quot;)</span>
<span class="co">#&gt; # A tibble: 10 x 3</span>
<span class="co">#&gt;      id yq     question</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   </span>
<span class="co">#&gt; 1     1 2018Q1 Yes     </span>
<span class="co">#&gt; 2     1 2018Q2 No      </span>
<span class="co">#&gt; 3     2 2018Q1 Yes     </span>
<span class="co">#&gt; 4     3 2018Q1 Yes     </span>
<span class="co">#&gt; 5     3 2018Q2 Yes     </span>
<span class="co">#&gt; 6     1 2018Q2 Method1 </span>
<span class="co">#&gt; # ... with 4 more rows</span>
<span class="kw">full_join</span>(x, y, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;yq&quot;</span>))
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt;      id yq     question.x question.y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1     1 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 2     1 2018Q2 No         Method1   </span>
<span class="co">#&gt; 3     2 2018Q1 Yes        Method2   </span>
<span class="co">#&gt; 4     3 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 5     3 2018Q2 Yes        Method2   </span>
<span class="co">#&gt; 6     2 2018Q2 &lt;NA&gt;       Method2   </span>
<span class="co">#&gt; # ... with 1 more row</span></code></pre></div>
</div>
<div id="duplicate-non-key-columns" class="section level3">
<h3><span class="header-section-number">11.1.3</span> Duplicate Non-Key Columns</h3>
<p>By default if there are variables in both data frames that are not used as a key the common variables names will be appended with <code>&quot;.x&quot;</code> and <code>&quot;.y&quot;</code> corresponding the the first and second argument. If you want to change these use the <code>suffix</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">full_join</span>(x, y, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;yq&quot;</span>), <span class="dt">suffix =</span> <span class="kw">c</span>(<span class="st">&quot;_1&quot;</span>, <span class="st">&quot;_2&quot;</span>))
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt;      id yq     question_1 question_2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1     1 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 2     1 2018Q2 No         Method1   </span>
<span class="co">#&gt; 3     2 2018Q1 Yes        Method2   </span>
<span class="co">#&gt; 4     3 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 5     3 2018Q2 Yes        Method2   </span>
<span class="co">#&gt; 6     2 2018Q2 &lt;NA&gt;       Method2   </span>
<span class="co">#&gt; # ... with 1 more row</span></code></pre></div>
</div>
<div id="different-key-column-names" class="section level3">
<h3><span class="header-section-number">11.1.4</span> Different Key Column Names</h3>
<p>A common occurrence is for the tables you wish to join to have different variable names. You can either change the variable names so the do match with <code>rename()</code> or you can use the <code>by</code> parameter to indicate which variable name in x matches the variable name in y.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yq, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Yes&quot;</span>
)

y2 &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yearquarter, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method1&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Method2&quot;</span>,
     <span class="dv">4</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Method1&quot;</span>
)

<span class="co"># inner</span>
<span class="kw">full_join</span>(x, y2, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;yq&quot;</span> =<span class="st"> &quot;yearquarter&quot;</span>), <span class="dt">suffix =</span> <span class="kw">c</span>(<span class="st">&quot;_1&quot;</span>, <span class="st">&quot;_2&quot;</span>))
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt;      id yq     question_1 question_2</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1     1 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 2     1 2018Q2 No         Method1   </span>
<span class="co">#&gt; 3     2 2018Q1 Yes        Method2   </span>
<span class="co">#&gt; 4     3 2018Q1 Yes        &lt;NA&gt;      </span>
<span class="co">#&gt; 5     3 2018Q2 Yes        Method2   </span>
<span class="co">#&gt; 6     2 2018Q2 &lt;NA&gt;       Method2   </span>
<span class="co">#&gt; # ... with 1 more row</span></code></pre></div>
</div>
</div>
<div id="filtering-joins" class="section level2">
<h2><span class="header-section-number">11.2</span> Filtering Joins</h2>
<p>Filtering joins match observations in the same way as mutating joins, but affect the observations, not the variables. There are two types:</p>
<ul>
<li><strong>semi join</strong> keeps all observations in x that have a match in y</li>
<li><strong>anti join</strong> drops all observations in x that have a match in y</li>
</ul>
<p><img src="images/relational/join-semi.png" width="307" style="display: block; margin: auto;" /> <img src="images/relational/join-anti.png" width="307" style="display: block; margin: auto;" /></p>
<p><strong>Semi-joins</strong> are useful for matching filtered summary tables back to the original rows. The inverse of a <strong>semi-join</strong> is an <strong>anti-join</strong>. An <strong>anti-join</strong> keeps the rows that don’t have a match. <strong>Anti-joins</strong> are useful for diagnosing join mismatches.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">orig &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yq, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Yes&quot;</span>
)

val &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>id, <span class="op">~</span>yq, <span class="op">~</span>question,
     <span class="dv">1</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">1</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">2</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;Yes&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q1&quot;</span>, <span class="st">&quot;No&quot;</span>,
     <span class="dv">3</span>, <span class="st">&quot;2018Q2&quot;</span>, <span class="st">&quot;Yes&quot;</span>
)

<span class="kw">semi_join</span>(orig, val, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;yq&quot;</span>, <span class="st">&quot;question&quot;</span>))
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;      id yq     question</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   </span>
<span class="co">#&gt; 1     1 2018Q2 No      </span>
<span class="co">#&gt; 2     2 2018Q1 Yes     </span>
<span class="co">#&gt; 3     3 2018Q2 Yes</span>

<span class="kw">anti_join</span>(orig, val, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;yq&quot;</span>, <span class="st">&quot;question&quot;</span>))
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;      id yq     question</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   </span>
<span class="co">#&gt; 1     1 2018Q1 Yes     </span>
<span class="co">#&gt; 2     3 2018Q1 Yes</span></code></pre></div>
</div>
<div id="set-operations" class="section level2">
<h2><span class="header-section-number">11.3</span> Set Operations</h2>
<p>The final type of two-table verb are the set operations. These operations work with a complete row, comparing the values of every variable. These expect the <code>x</code> and <code>y</code> inputs to have the same variables, in the same order, and treat the observations like sets:</p>
<ul>
<li><code>intersect(x, y)</code>: return only observations in both <code>x</code> and <code>y</code>.</li>
<li><code>union(x, y)</code>: return unique observations in <code>x</code> and <code>y</code>.</li>
<li><code>setdiff(x, y)</code>: return observations in <code>x</code>, but not in <code>y</code>.</li>
</ul>
<p>Given this simple data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>x, <span class="op">~</span>y,
   <span class="dv">1</span>,  <span class="dv">1</span>,
   <span class="dv">2</span>,  <span class="dv">1</span>
)
df2 &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>x, <span class="op">~</span>y,
   <span class="dv">1</span>,  <span class="dv">1</span>,
   <span class="dv">1</span>,  <span class="dv">2</span>
)</code></pre></div>
<p>The four possibilities are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">intersect</span>(df1, df2)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1     1</span>

<span class="co"># Note that we get 3 rows, not 4</span>
<span class="kw">union</span>(df1, df2)
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1     2</span>
<span class="co">#&gt; 2     2     1</span>
<span class="co">#&gt; 3     1     1</span>

<span class="kw">setdiff</span>(df1, df2)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     2     1</span>

<span class="kw">setdiff</span>(df2, df1)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1     2</span></code></pre></div>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="tidy-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DavisBrian/corporater/edit/master/data-relational.Rmd",
"text": "Edit"
},
"download": ["rclassnotes.pdf", "rclassnotes.epub"],
"toc": {
"collapse": "section"
},
"css": "corp.css"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
