<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Modern R in a Corporate Environment</title>
  <meta name="description" content="This is an original course for RADARS">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Modern R in a Corporate Environment" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an original course for RADARS" />
  <meta name="github-repo" content="DavisBrian/corporater" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Modern R in a Corporate Environment" />
  
  <meta name="twitter:description" content="This is an original course for RADARS" />
  

<meta name="author" content="Brian Davis">


<meta name="date" content="2018-10-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="good-practices.html">
<link rel="next" href="data-import.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern R in a Corporate Environment</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Preamble</b></span></li>
<li class="chapter" data-level="1" data-path="preamble-intro.html"><a href="preamble-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="preamble-intro.html"><a href="preamble-intro.html#course-philosophy"><i class="fa fa-check"></i><b>1.1</b> Course Philosophy</a><ul>
<li class="chapter" data-level="1.1.1" data-path="preamble-intro.html"><a href="preamble-intro.html#reproducible-research-approach"><i class="fa fa-check"></i><b>1.1.1</b> Reproducible Research Approach</a></li>
<li class="chapter" data-level="1.1.2" data-path="preamble-intro.html"><a href="preamble-intro.html#fda-validation"><i class="fa fa-check"></i><b>1.1.2</b> FDA Validation</a></li>
<li class="chapter" data-level="1.1.3" data-path="preamble-intro.html"><a href="preamble-intro.html#the-sas-myth"><i class="fa fa-check"></i><b>1.1.3</b> The SAS Myth</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="preamble-intro.html"><a href="preamble-intro.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="preamble-intro.html"><a href="preamble-intro.html#content"><i class="fa fa-check"></i><b>1.3</b> Content</a></li>
<li class="chapter" data-level="1.4" data-path="preamble-intro.html"><a href="preamble-intro.html#structure"><i class="fa fa-check"></i><b>1.4</b> Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>2</b> Good practices</a><ul>
<li class="chapter" data-level="2.1" data-path="good-practices.html"><a href="good-practices.html#coding-style"><i class="fa fa-check"></i><b>2.1</b> Coding style</a><ul>
<li class="chapter" data-level="2.1.1" data-path="good-practices.html"><a href="good-practices.html#comments"><i class="fa fa-check"></i><b>2.1.1</b> Comments</a></li>
<li class="chapter" data-level="2.1.2" data-path="good-practices.html"><a href="good-practices.html#naming"><i class="fa fa-check"></i><b>2.1.2</b> Naming</a></li>
<li class="chapter" data-level="2.1.3" data-path="good-practices.html"><a href="good-practices.html#spacing"><i class="fa fa-check"></i><b>2.1.3</b> Spacing</a></li>
<li class="chapter" data-level="2.1.4" data-path="good-practices.html"><a href="good-practices.html#indenting"><i class="fa fa-check"></i><b>2.1.4</b> Indenting</a></li>
<li class="chapter" data-level="2.1.5" data-path="good-practices.html"><a href="good-practices.html#long-lines"><i class="fa fa-check"></i><b>2.1.5</b> Long lines</a></li>
<li class="chapter" data-level="2.1.6" data-path="good-practices.html"><a href="good-practices.html#other"><i class="fa fa-check"></i><b>2.1.6</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="good-practices.html"><a href="good-practices.html#coding-practices"><i class="fa fa-check"></i><b>2.2</b> Coding practices</a><ul>
<li class="chapter" data-level="2.2.1" data-path="good-practices.html"><a href="good-practices.html#variables"><i class="fa fa-check"></i><b>2.2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="good-practices.html"><a href="good-practices.html#rule-of-threedry"><i class="fa fa-check"></i><b>2.2.2</b> <em>Rule of Three</em></a></li>
<li class="chapter" data-level="2.2.3" data-path="good-practices.html"><a href="good-practices.html#path-names"><i class="fa fa-check"></i><b>2.2.3</b> Path names</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="good-practices.html"><a href="good-practices.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="good-practices.html"><a href="good-practices.html#getting-help"><i class="fa fa-check"></i><b>2.4</b> Getting help</a><ul>
<li class="chapter" data-level="2.4.1" data-path="good-practices.html"><a href="good-practices.html#help-yourself-learn-how-to-debug"><i class="fa fa-check"></i><b>2.4.1</b> Help yourself, learn how to debug</a></li>
<li class="chapter" data-level="2.4.2" data-path="good-practices.html"><a href="good-practices.html#external-help"><i class="fa fa-check"></i><b>2.4.2</b> External help</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="good-practices.html"><a href="good-practices.html#keeping-up-to-date"><i class="fa fa-check"></i><b>2.5</b> Keeping up to date</a></li>
<li class="chapter" data-level="2.6" data-path="good-practices.html"><a href="good-practices.html#reading-for-next-class"><i class="fa fa-check"></i><b>2.6</b> Reading For Next Class</a></li>
<li class="chapter" data-level="2.7" data-path="good-practices.html"><a href="good-practices.html#exercises"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Base R Basics</b></span></li>
<li class="chapter" data-level="3" data-path="baser-rbasics.html"><a href="baser-rbasics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#assignment-operators"><i class="fa fa-check"></i><b>3.1</b> Assignment Operators</a></li>
<li class="chapter" data-level="3.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#naming-rules"><i class="fa fa-check"></i><b>3.2</b> Naming Rules</a></li>
<li class="chapter" data-level="3.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a><ul>
<li class="chapter" data-level="3.3.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#vector"><i class="fa fa-check"></i><b>3.3.1</b> Vector</a></li>
<li class="chapter" data-level="3.3.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#atomic-vectors"><i class="fa fa-check"></i><b>3.3.2</b> Atomic Vectors</a></li>
<li class="chapter" data-level="3.3.3" data-path="baser-rbasics.html"><a href="baser-rbasics.html#matrix"><i class="fa fa-check"></i><b>3.3.3</b> Matrix</a></li>
<li class="chapter" data-level="3.3.4" data-path="baser-rbasics.html"><a href="baser-rbasics.html#list"><i class="fa fa-check"></i><b>3.3.4</b> List</a></li>
<li class="chapter" data-level="3.3.5" data-path="baser-rbasics.html"><a href="baser-rbasics.html#data-frame"><i class="fa fa-check"></i><b>3.3.5</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="baser-rbasics.html"><a href="baser-rbasics.html#comparision"><i class="fa fa-check"></i><b>3.4</b> Comparision</a></li>
<li class="chapter" data-level="3.5" data-path="baser-rbasics.html"><a href="baser-rbasics.html#logical-and-sets"><i class="fa fa-check"></i><b>3.5</b> Logical and sets</a></li>
<li class="chapter" data-level="3.6" data-path="baser-rbasics.html"><a href="baser-rbasics.html#control-structures"><i class="fa fa-check"></i><b>3.6</b> Control Structures</a><ul>
<li class="chapter" data-level="3.6.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#if-else"><i class="fa fa-check"></i><b>3.6.1</b> <code>if</code>-<code>else</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="baser-rbasics.html"><a href="baser-rbasics.html#for-loops"><i class="fa fa-check"></i><b>3.6.2</b> <code>for</code> Loops</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="baser-rbasics.html"><a href="baser-rbasics.html#vectorization-recycling"><i class="fa fa-check"></i><b>3.7</b> Vectorization &amp; Recycling</a><ul>
<li class="chapter" data-level="3.7.1" data-path="baser-rbasics.html"><a href="baser-rbasics.html#example"><i class="fa fa-check"></i><b>3.7.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="baser-rbasics.html"><a href="baser-rbasics.html#reading-for-next-class-1"><i class="fa fa-check"></i><b>3.8</b> Reading For Next Class</a></li>
<li class="chapter" data-level="3.9" data-path="baser-rbasics.html"><a href="baser-rbasics.html#exercises-1"><i class="fa fa-check"></i><b>3.9</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III R4DS</b></span></li>
<li class="chapter" data-level="4" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>4</b> Data Import</a><ul>
<li class="chapter" data-level="4.1" data-path="data-import.html"><a href="data-import.html#text-files"><i class="fa fa-check"></i><b>4.1</b> Text Files</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-import.html"><a href="data-import.html#readr"><i class="fa fa-check"></i><b>4.1.1</b> readr</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-import.html"><a href="data-import.html#base-r"><i class="fa fa-check"></i><b>4.1.2</b> base R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-import.html"><a href="data-import.html#sas-files"><i class="fa fa-check"></i><b>4.2</b> SAS Files</a></li>
<li class="chapter" data-level="4.3" data-path="data-import.html"><a href="data-import.html#excel"><i class="fa fa-check"></i><b>4.3</b> Excel</a></li>
<li class="chapter" data-level="4.4" data-path="data-import.html"><a href="data-import.html#databases"><i class="fa fa-check"></i><b>4.4</b> Databases</a></li>
<li class="chapter" data-level="4.5" data-path="data-import.html"><a href="data-import.html#reading-for-next-class-2"><i class="fa fa-check"></i><b>4.5</b> Reading For Next Class</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a><ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#tibbles"><i class="fa fa-check"></i><b>5.1</b> Tibbles</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>5.2</b> Filter rows with <code>filter()</code></a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>5.3</b> Arrange rows with <code>arrange()</code></a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#select-columns-with-select"><i class="fa fa-check"></i><b>5.4</b> Select columns with <code>select()</code></a></li>
<li class="chapter" data-level="5.5" data-path="data-transformation.html"><a href="data-transformation.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>5.5</b> Add new variables with <code>mutate()</code></a></li>
<li class="chapter" data-level="5.6" data-path="data-transformation.html"><a href="data-transformation.html#pipes"><i class="fa fa-check"></i><b>5.6</b> Pipes</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-transformation.html"><a href="data-transformation.html#intermediate-steps"><i class="fa fa-check"></i><b>5.6.1</b> Intermediate steps</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-transformation.html"><a href="data-transformation.html#overwrite-the-original"><i class="fa fa-check"></i><b>5.6.2</b> Overwrite the original</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-transformation.html"><a href="data-transformation.html#function-composition"><i class="fa fa-check"></i><b>5.6.3</b> Function composition</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-transformation.html"><a href="data-transformation.html#use-the-pipe-operator"><i class="fa fa-check"></i><b>5.6.4</b> Use the pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-transformation.html"><a href="data-transformation.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>5.7</b> Grouped summaries with <code>summarise()</code></a></li>
<li class="chapter" data-level="5.8" data-path="data-transformation.html"><a href="data-transformation.html#grouped-mutates"><i class="fa fa-check"></i><b>5.8</b> Grouped mutates</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="6" data-path="appendix-resources.html"><a href="appendix-resources.html"><i class="fa fa-check"></i><b>6</b> Appendix A</a><ul>
<li class="chapter" data-level="6.1" data-path="appendix-resources.html"><a href="appendix-resources.html#e-books"><i class="fa fa-check"></i><b>6.1</b> E-Books</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern R in a Corporate Environment</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="baser-rbasics" class="section level1">
<h1><span class="header-section-number">3</span> R Basics</h1>
<p>Here is a quick overview of the basics. We will dive deep into R’s basic data structures and then how to subset those data structures later in the course. This will give us a good overview of base R and the background needed to dive into <a href="http://r4ds.had.co.nz/index.html">R for Data Science</a>.</p>
<p>The three most important functions in R <code>?</code>, <code>??</code>, and <code>str</code>:</p>
<ul>
<li><code>?topic</code> provides access to the documentation for <em>topic</em>.</li>
<li><code>??topic</code> searches the documentation for <em>topic</em>.</li>
<li><code>str</code> displays the structure of an R object in human readable form.</li>
</ul>

<div class="rmdtip">
<code>glimpse</code> is a tidyverse equivalent to <code>str</code> but with nicer output for complicated data structures.
</div>

<p>See this <a href="http://adv-r.had.co.nz/Vocabulary.html">vocabulary list</a> for a good starting point on the basics functions in base R and some important libraries.</p>
<p>A book to learn the basics is <a href="https://bookdown.org/rdpeng/rprogdatascience/">R Programming for Data Science</a></p>
<p>In R there three basic constructs<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>; objects, functions, and environments.</p>
<div id="assignment-operators" class="section level2">
<h2><span class="header-section-number">3.1</span> Assignment Operators</h2>
<p>We saw this is Coding Style. Use <code>&lt;-</code> for assignment and use <code>=</code> for parameters. While you can use <code>=</code> for assignment it is generally considered bad practice.</p>
</div>
<div id="naming-rules" class="section level2">
<h2><span class="header-section-number">3.2</span> Naming Rules</h2>
<p>R has strict rules about what constitutes a valid name. A <strong>syntactic</strong> name must consist of letters<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>, digits, <code>.</code> and <code>_</code>, and can’t begin with <code>_</code>. Additionally, it can not be one of a list of <strong>reserved words</strong> like <code>TRUE</code>, <code>NULL</code>, <code>if</code>, and <code>function</code> (see the complete list in <code>?Reserved</code>). Names that don’t follow these rules are called <strong>non-syntactic</strong> names, and if you try to use them, you’ll get an error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">_abc &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co">#&gt; Error: unexpected input in &quot;_&quot;</span>

<span class="cf">if</span> &lt;-<span class="st"> </span><span class="dv">10</span>
<span class="co">#&gt; Error: unexpected assignment in &quot;if &lt;-&quot;</span></code></pre></div>
<div class="rmdwarning">
<p>
While <code>TRUE</code> and <code>FALSE</code> are reserved words <code>T</code> and <code>F</code> are not. However, you can use <code>T</code> and <code>F</code> as logical. If someone assigns either of those a different value you will get a <strong>very</strong> hard to track down bug. Always spell out the <code>TRUE</code> and <code>FALSE</code>.
</p>
</div>
</div>
<div id="objects" class="section level2">
<h2><span class="header-section-number">3.3</span> Objects</h2>
<div id="vector" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Vector</h3>
<p>You create a vector with <code>c</code>. These have to be the same data type (See next section).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;my&quot;</span>, <span class="st">&quot;first&quot;</span>, <span class="st">&quot;vector&quot;</span>)
v
<span class="co">#&gt; [1] &quot;my&quot;     &quot;first&quot;  &quot;vector&quot;</span>

<span class="co"># length of our vector</span>
<span class="kw">length</span>(v)
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>There are several shortcut functions for common vector creation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create an ordered sequence</span>
<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>
<span class="co">#&gt; [1]  2  3  4  5  6  7  8  9 10</span>
<span class="dv">9</span><span class="op">:</span><span class="dv">3</span>
<span class="co">#&gt; [1] 9 8 7 6 5 4 3</span>

<span class="co"># generate regular sequences</span>
<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">3</span>)
<span class="co">#&gt; [1]  1  4  7 10 13 16 19</span>

<span class="co"># replicate a number n times</span>
<span class="kw">rep</span>(<span class="dv">3</span>, <span class="dt">times =</span> <span class="dv">4</span>)
<span class="co">#&gt; [1] 3 3 3 3</span>

<span class="co"># arguments are generally vectorized</span>
<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="dv">3</span><span class="op">:</span><span class="dv">1</span>)
<span class="co">#&gt; [1] 1 1 1 2 2 3</span>

<span class="co"># common mistake using 1:length(n) in loops</span>
<span class="co"># but if n = 0</span>
<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>
<span class="co">#&gt; [1] 1 0</span>

<span class="co"># use seq_len(n) instead and the loop won&#39;t execute</span>
<span class="kw">seq_len</span>(<span class="dv">0</span>)
<span class="co">#&gt; integer(0)</span>

<span class="co"># another common mistake</span>
n &lt;-<span class="st"> </span><span class="dv">6</span>
<span class="dv">1</span><span class="op">:</span>n<span class="op">+</span><span class="dv">1</span>        <span class="co"># is (1:n) + 1, so 2:(n + 1)</span>
<span class="co">#&gt; [1] 2 3 4 5 6 7</span>
<span class="dv">1</span><span class="op">:</span>(n<span class="op">+</span><span class="dv">1</span>)      <span class="co"># usually what is meant</span>
<span class="co">#&gt; [1] 1 2 3 4 5 6 7</span>
<span class="kw">seq_len</span>(n<span class="op">+</span><span class="dv">1</span>) <span class="co"># a better way</span>
<span class="co">#&gt; [1] 1 2 3 4 5 6 7</span></code></pre></div>
</div>
<div id="atomic-vectors" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Atomic Vectors</h3>
<p>There are many “atomic” types of data: <code>logical</code>, <code>integer</code>, <code>double</code> and <code>character</code> (in this order, see below). There are also <code>raw</code> and <code>complex</code> but they are rarely used.</p>
<p>You can’t mix types in an atomic vector (you can in a list). Coercion will automatically occur if you mix types:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(a &lt;-<span class="st"> </span><span class="ot">FALSE</span>)
<span class="co">#&gt; [1] FALSE</span>
<span class="kw">typeof</span>(a)
<span class="co">#&gt; [1] &quot;logical&quot;</span>

(b &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span>
<span class="kw">typeof</span>(b)
<span class="co">#&gt; [1] &quot;integer&quot;</span>
<span class="kw">c</span>(a, b)         ## FALSE is coerced to integer 0
<span class="co">#&gt;  [1]  0  1  2  3  4  5  6  7  8  9 10</span>

(c &lt;-<span class="st"> </span><span class="fl">10.5</span>)
<span class="co">#&gt; [1] 10.5</span>
<span class="kw">typeof</span>(c)
<span class="co">#&gt; [1] &quot;double&quot;</span>
(d &lt;-<span class="st"> </span><span class="kw">c</span>(b, c))  ## coerced to double
<span class="co">#&gt;  [1]  1.0  2.0  3.0  4.0  5.0  6.0  7.0  8.0  9.0 10.0 10.5</span>

<span class="kw">c</span>(d, <span class="st">&quot;a&quot;</span>)       ## coerced to character
<span class="co">#&gt;  [1] &quot;1&quot;    &quot;2&quot;    &quot;3&quot;    &quot;4&quot;    &quot;5&quot;    &quot;6&quot;    &quot;7&quot;    &quot;8&quot;    &quot;9&quot;    &quot;10&quot;  </span>
<span class="co">#&gt; [11] &quot;10.5&quot; &quot;a&quot;</span>

<span class="dv">50</span> <span class="op">&lt;</span><span class="st"> &quot;7&quot;</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>You can force coercion with <code>as.logical</code>, <code>as.integer</code>, <code>as.double</code>, <code>as.numeric</code>, and <code>as.character</code>. Most of the time the coercion rules are straight forward, but not always.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
<span class="kw">typeof</span>(x)
<span class="co">#&gt; [1] &quot;logical&quot;</span>

<span class="kw">as.integer</span>(x)
<span class="co">#&gt; [1] 1 0</span>
<span class="kw">as.numeric</span>(x)
<span class="co">#&gt; [1] 1 0</span>
<span class="kw">as.character</span>(x)
<span class="co">#&gt; [1] &quot;TRUE&quot;  &quot;FALSE&quot;</span></code></pre></div>
<p>However, coercion is not associative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)

x2 &lt;-<span class="st"> </span><span class="kw">as.integer</span>(x)
x3 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x2)
<span class="kw">as.character</span>(x3)
<span class="co">#&gt; [1] &quot;1&quot; &quot;0&quot;</span></code></pre></div>
<p>What would you expect this to return?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)

<span class="kw">as.integer</span>(<span class="kw">as.character</span>(x))</code></pre></div>
<p>You can test for an “atomic” types of data with: <code>is.logical</code>, <code>is.integer</code>, <code>is.double</code>, <code>is.numeric</code><a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>, and <code>is.character</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)

<span class="kw">is.logical</span>(x)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">is.integer</span>(x)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>What would you expect these to return?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">2</span>

<span class="kw">is.integer</span>(x)
<span class="kw">is.numeric</span>(x)
<span class="kw">is.double</span>(x)</code></pre></div>
<p>Missing values are specified with <code>NA</code>, which is a logical vector of length 1. <code>NA</code> will always be coerced to the correct type if used inside <code>c()</code>, or you can create <code>NA</code>s of a specific type with <code>NA_real_</code> (a double vector), <code>NA_integer_</code> and <code>NA_character_</code>.</p>
</div>
<div id="matrix" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Matrix</h3>
<p>Matrices are 2D vectors, with all elements of the same type. Generally used for mathematics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fill in column order (default)</span>
<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    1    4    7   10</span>
<span class="co">#&gt; [2,]    2    5    8   11</span>
<span class="co">#&gt; [3,]    3    6    9   12</span>

<span class="co"># fill in row order</span>
<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    1    2    3    4</span>
<span class="co">#&gt; [2,]    5    6    7    8</span>
<span class="co">#&gt; [3,]    9   10   11   12</span>

<span class="co"># can also specify the number of columns instead</span>
<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    1    5    9</span>
<span class="co">#&gt; [2,]    2    6   10</span>
<span class="co">#&gt; [3,]    3    7   11</span>
<span class="co">#&gt; [4,]    4    8   12</span></code></pre></div>
<p>You find the dimensions of a matrix with <code>nrow</code>, <code>ncol</code>, and <code>dim</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)
<span class="kw">dim</span>(m)
<span class="co">#&gt; [1] 4 3</span>
<span class="kw">nrow</span>(m)
<span class="co">#&gt; [1] 4</span>
<span class="kw">ncol</span>(m)
<span class="co">#&gt; [1] 3</span></code></pre></div>
</div>
<div id="list" class="section level3">
<h3><span class="header-section-number">3.3.4</span> List</h3>
<p>A list is a generic vector containing other objects. These do <strong>NOT</strong> have to be the same type or the same length.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aa&quot;</span>, <span class="st">&quot;bb&quot;</span>, <span class="st">&quot;cc&quot;</span>, <span class="st">&quot;dd&quot;</span>, <span class="st">&quot;ee&quot;</span>) 
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>) 
<span class="co"># x contains copies of n, s, b and our matrix from above</span>
x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>) , s, b, <span class="dv">3</span>, m)   
x
<span class="co">#&gt; $n</span>
<span class="co">#&gt; [1] 2 3 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] &quot;aa&quot; &quot;bb&quot; &quot;cc&quot; &quot;dd&quot; &quot;ee&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1]  TRUE FALSE  TRUE FALSE FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    1    5    9</span>
<span class="co">#&gt; [2,]    2    6   10</span>
<span class="co">#&gt; [3,]    3    7   11</span>
<span class="co">#&gt; [4,]    4    8   12</span>

<span class="co"># length gives you length of the list not the elements in the list</span>
<span class="kw">length</span>(x)
<span class="co">#&gt; [1] 5</span></code></pre></div>
<p>We’ll discuss lists in more detail later in the course.</p>
</div>
<div id="data-frame" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Data frame</h3>
<p>A data frame is a list with each vector of the same length. This is the main data structure used and is analogous to a data set in SAS. While these <strong>look</strong> like matrices they behave very different.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>),
                <span class="dt">s =</span> <span class="kw">c</span>(<span class="st">&quot;aa&quot;</span>, <span class="st">&quot;bb&quot;</span>, <span class="st">&quot;cc&quot;</span>),
                <span class="dt">b =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>),
                <span class="dt">y =</span> v
                )       <span class="co"># df is a data frame </span>
df
<span class="co">#&gt;   n  s     b      y</span>
<span class="co">#&gt; 1 2 aa  TRUE     my</span>
<span class="co">#&gt; 2 3 bb FALSE  first</span>
<span class="co">#&gt; 3 5 cc  TRUE vector</span>

<span class="co"># dimensions</span>
<span class="kw">dim</span>(df)
<span class="co">#&gt; [1] 3 4</span>
<span class="kw">nrow</span>(df)
<span class="co">#&gt; [1] 3</span>
<span class="kw">ncol</span>(df)
<span class="co">#&gt; [1] 4</span>
<span class="kw">length</span>(df)
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>We’ll discuss data frames in greater detail later in the course.</p>
</div>
</div>
<div id="comparision" class="section level2">
<h2><span class="header-section-number">3.4</span> Comparision</h2>
<table>
<caption><span id="tab:table-logicalOps">TABLE 3.1: </span>Logical Operators</caption>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">greater than</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">greater than or equal to</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">less than</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">less than or equal to</td>
</tr>
<tr class="odd">
<td align="left">==</td>
<td align="left">exactly equal to</td>
</tr>
<tr class="even">
<td align="left">!=</td>
<td align="left">not equal to</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>
v[v <span class="op">&gt;</span><span class="st"> </span><span class="dv">9</span>]
<span class="co">#&gt; [1] 10 11 12</span></code></pre></div>
<p>Equality can be tricky to test for since real numbers can’t be expressed exactly in computers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)
(y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)
<span class="co">#&gt; [1] 2</span>
y <span class="op">==</span><span class="st"> </span><span class="dv">2</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="kw">print</span>(y, <span class="dt">digits =</span> <span class="dv">20</span>)
<span class="co">#&gt; [1] 2.0000000000000004</span>
<span class="kw">all.equal</span>(y, <span class="dv">2</span>)          ## equality with some tolerance
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">all.equal</span>(y, <span class="dv">3</span>)
<span class="co">#&gt; [1] &quot;Mean relative difference: 0.5&quot;</span>
<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(y, <span class="dv">3</span>))  ## if you want a boolean, use isTRUE()
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
</div>
<div id="logical-and-sets" class="section level2">
<h2><span class="header-section-number">3.5</span> Logical and sets</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">expand.grid</span>(x, x))
<span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)
df<span class="op">$</span>and  &lt;-<span class="st"> </span>df<span class="op">$</span>x <span class="op">&amp;</span><span class="st"> </span>df<span class="op">$</span>y     <span class="co"># logical and</span>
df<span class="op">$</span>or   &lt;-<span class="st"> </span>df<span class="op">$</span>x <span class="op">|</span><span class="st"> </span>df<span class="op">$</span>y     <span class="co"># logical or</span>
df<span class="op">$</span>notx &lt;-<span class="st"> </span><span class="op">!</span>df<span class="op">$</span>x           <span class="co"># negation</span>
df<span class="op">$</span>xor  &lt;-<span class="st"> </span><span class="kw">xor</span>(df<span class="op">$</span>x, df<span class="op">$</span>y) <span class="co"># exlusive or</span>
df
<span class="co">#&gt;       x     y   and    or  notx   xor</span>
<span class="co">#&gt; 1  TRUE  TRUE  TRUE  TRUE FALSE FALSE</span>
<span class="co">#&gt; 2 FALSE  TRUE FALSE  TRUE  TRUE  TRUE</span>
<span class="co">#&gt; 3  TRUE FALSE FALSE  TRUE FALSE  TRUE</span>
<span class="co">#&gt; 4 FALSE FALSE FALSE FALSE  TRUE FALSE</span></code></pre></div>
<p>R has two versions of the logical operators <code>&amp;</code> and <code>&amp;&amp;</code> (<code>|</code> and <code>||</code>). The single version is the vectorized version while the the double version returns a length-one vector. Use the double version in logical control structures (if, for, while, etc).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>x <span class="op">&amp;&amp;</span><span class="st"> </span>df<span class="op">$</span>y  <span class="co"># only and the first elements</span>
<span class="co">#&gt; [1] TRUE</span>
df<span class="op">$</span>x <span class="op">||</span><span class="st"> </span>df<span class="op">$</span>y  <span class="co"># only or the first elements</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>This is a common source of bugs in control structures (if, for, while, etc) where you must have a single TRUE / FALSE.</p>
<div class="rmdcaution">
<p>
<code>=</code> is used for assignment while <code>==</code> is used for comparison. A common bug is to use <code>=</code> instead of <code>==</code> inside a control structure.
</p>
</div>
<p>It also has useful helpers <code>any</code> and <code>all</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)
<span class="kw">any</span>(x)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">all</span>(x)
<span class="co">#&gt; [1] FALSE</span>
<span class="kw">all</span>(<span class="op">!</span>x[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>And also some useful <strong>set</strong> operations <code>intersect</code>, <code>union</code>, <code>setdiff</code>, <code>setequal</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>
y &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">7</span>

<span class="kw">intersect</span>(x, y) <span class="co"># in x and in y</span>
<span class="co">#&gt; [1] 3 4 5</span>
<span class="kw">union</span>(x, y)     <span class="co"># different than c()</span>
<span class="co">#&gt; [1] 1 2 3 4 5 6 7</span>
<span class="kw">c</span>(x,y)          <span class="co"># not a set operation</span>
<span class="co">#&gt;  [1] 1 2 3 4 5 3 4 5 6 7</span>
<span class="kw">setdiff</span>(x, y)   <span class="co"># in x but not in y</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="kw">setdiff</span>(y, x)   <span class="co"># in y but not in x</span>
<span class="co">#&gt; [1] 6 7</span>
<span class="kw">setequal</span>(x, y)
<span class="co">#&gt; [1] FALSE</span>
z &lt;-<span class="st"> </span><span class="dv">5</span><span class="op">:</span><span class="dv">1</span>
<span class="kw">setequal</span>(x, z)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="control-structures" class="section level2">
<h2><span class="header-section-number">3.6</span> Control Structures</h2>
<p>Control structures allow you to put some “logic” into your R code, rather than just always executing the same R code every time. Control structures allow you to respond to inputs or to features of the data and execute different R expressions accordingly.</p>
<p>Commonly used control structures are</p>
<ul>
<li><p><code>if</code> and <code>else</code>: testing a condition and acting on it</p></li>
<li><p><code>for</code>: execute a loop a fixed number of times</p></li>
<li><p><code>while</code>: execute a loop <em>while</em> a condition is true</p></li>
<li><p><code>repeat</code>: execute an infinite loop (must <code>break</code> out of it to stop)</p></li>
<li><p><code>break</code>: break the execution of a loop</p></li>
<li><p><code>next</code>: skip an iteration of a loop</p></li>
</ul>
<div id="if-else" class="section level3">
<h3><span class="header-section-number">3.6.1</span> <code>if</code>-<code>else</code></h3>
<p>The <code>if</code>-<code>else</code> combination is probably the most commonly used control structure in R (or perhaps any language). This structure allows you to test a condition and act on it depending on whether it’s true or false.</p>
<p>For starters, you can just use the <code>if</code> statement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">&lt;</span>condition<span class="op">&gt;</span>) {
        <span class="co"># do something</span>
} 
<span class="co"># Continue with rest of code</span></code></pre></div>
<p>The above code does nothing if the condition is false. If you have an action you want to execute when the condition is false, then you need an <code>else</code> clause.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">&lt;</span>condition<span class="op">&gt;</span>) {
        <span class="co"># do something</span>
} 
<span class="cf">else</span> {
        <span class="co"># do something else</span>
}</code></pre></div>
<p>You can have a series of tests by following the initial <code>if</code> with any number of <code>else if</code>s.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">&lt;</span>condition1<span class="op">&gt;</span>) {
        <span class="co"># do something</span>
} <span class="cf">else</span> <span class="cf">if</span>(<span class="op">&lt;</span>condition2<span class="op">&gt;</span>)  {
        <span class="co"># do something different</span>
} <span class="cf">else</span> {
        <span class="co"># do something else different</span>
}</code></pre></div>
<div class="rmdwarning">
<p>
There is also an <code>ifelse</code> function which is vectorized version. It is essentially an <code>if</code>-<code>else</code> wrapped in a <code>for</code> loop so that the condition, and action, is performed on each element in a vector.
</p>
</div>
</div>
<div id="for-loops" class="section level3">
<h3><span class="header-section-number">3.6.2</span> <code>for</code> Loops</h3>
<p>For loops are pretty much the only looping construct that you will need in R. While you may occasionally find a need for other types of loops, in my experience doing data analysis, I’ve found very few situations where a for loop wasn’t sufficient.</p>
<p>In R, for loops take an iterator variable and assign it successive values from a sequence or vector. For loops are most commonly used for iterating over the elements of an object (list, vector, etc.)</p>
<p>The following three loops all have the similar behavior.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
        ## Print out each element of &#39;x&#39;
        <span class="kw">print</span>(x[i])  
}
<span class="co">#&gt; [1] &quot;a&quot;</span>
<span class="co">#&gt; [1] &quot;b&quot;</span>
<span class="co">#&gt; [1] &quot;c&quot;</span>
<span class="co">#&gt; [1] &quot;d&quot;</span></code></pre></div>
<p>The <code>seq_along()</code> function is commonly used in conjunction with for loops in order to generate an integer sequence based on the length of an object (in this case, the object <code>x</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate a sequence based on length of &#39;x&#39;
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {   
        <span class="kw">print</span>(x[i])
}
<span class="co">#&gt; [1] &quot;a&quot;</span>
<span class="co">#&gt; [1] &quot;b&quot;</span>
<span class="co">#&gt; [1] &quot;c&quot;</span>
<span class="co">#&gt; [1] &quot;d&quot;</span></code></pre></div>
<p>It is not necessary to use an index-type variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(letter <span class="cf">in</span> x) {
        <span class="kw">print</span>(letter)
}
<span class="co">#&gt; [1] &quot;a&quot;</span>
<span class="co">#&gt; [1] &quot;b&quot;</span>
<span class="co">#&gt; [1] &quot;c&quot;</span>
<span class="co">#&gt; [1] &quot;d&quot;</span></code></pre></div>

<div class="rmdtip">
Nested loops are commonly needed for multidimensional or hierarchical data structures (e.g. matrices, lists). Be careful with nesting though. Nesting beyond 2 to 3 levels often makes it difficult to read/understand the code. If you find yourself in need of a large number of nested loops, you probably want to break up the loops by using functions (discussed later).
</div>

<p>We will discus looping and the other control structures in more detail when we get to the section on iterators.</p>
</div>
</div>
<div id="vectorization-recycling" class="section level2">
<h2><span class="header-section-number">3.7</span> Vectorization &amp; Recycling</h2>
<p>Many operations in R are <em>vectorized</em>, meaning that operations occur in parallel in certain R objects. This allows you to write code that is efficient, concise, and easier to read than in non-vectorized languages.</p>
<p>The simplest example is when adding two vectors together.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>
y &lt;-<span class="st"> </span><span class="dv">11</span><span class="op">:</span><span class="dv">13</span>
z &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y
z
<span class="co">#&gt; [1] 12 14 16</span></code></pre></div>
<p>In most other languages you would have to do something like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))

<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
      z[i] &lt;-<span class="st"> </span>x[i] <span class="op">+</span><span class="st"> </span>y[i]
}
z
<span class="co">#&gt; [1] 12 14 16</span></code></pre></div>
<p>We saw a form of vectorization above in the logical operators.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x
<span class="co">#&gt; [1] 1 2 3</span>
x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>
<span class="co">#&gt; [1] FALSE FALSE  TRUE</span>
x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>]
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>Matrix operations are also vectorized, making for nice compact notation. This way, we can do element-by-element operations on matrices without having to loop over every element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)
y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>)
x
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]    1    3</span>
<span class="co">#&gt; [2,]    2    4</span>
y
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   10   10</span>
<span class="co">#&gt; [2,]   10   10</span>
x <span class="op">*</span><span class="st"> </span>y  <span class="co"># element-wise multiplication</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   10   30</span>
<span class="co">#&gt; [2,]   20   40</span>
x <span class="op">/</span><span class="st"> </span>y  <span class="co"># element-wise division</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]  0.1  0.3</span>
<span class="co">#&gt; [2,]  0.2  0.4</span>
x <span class="op">%*%</span><span class="st"> </span>y  <span class="co"># true matrix multiplication</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   40   40</span>
<span class="co">#&gt; [2,]   60   60</span></code></pre></div>
<p>R also recycles arguments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>
z &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span>.<span class="dv">1</span>  <span class="co"># add .1 to each element</span>
z
<span class="co">#&gt;  [1]  1.1  2.1  3.1  4.1  5.1  6.1  7.1  8.1  9.1 10.1</span></code></pre></div>
<p>While you usually either want the same length vector or a length one vector. You are not limited to just these options.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>
y &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>) 
y
<span class="co">#&gt;  [1]  1.1  2.2  3.1  4.2  5.1  6.2  7.1  8.2  9.1 10.2</span>
z &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">3</span>)
<span class="co">#&gt; Warning in x + c(0.1, 0.2, 0.3): longer object length is not a multiple of</span>
<span class="co">#&gt; shorter object length</span>
z
<span class="co">#&gt;  [1]  1.1  2.2  3.3  4.1  5.2  6.3  7.1  8.2  9.3 10.1</span></code></pre></div>
<div id="example" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Example</h3>
<p>One (not so good) way to estimate <code>pi</code> is through Monte-Carlo simulation.</p>
<p>Suppose we wish to estimate the value of <code>pi</code> using a Monte-Carlo method. Essentially, we throw darts at the unit square and count the number of darts that fall within the unit circle. We’ll only deal with quadrant one. Thus the <span class="math inline">\(Area = \frac{\pi}{4}\)</span></p>
<p>Monte-Carlo pseudo code:</p>
<ol style="list-style-type: decimal">
<li>Initialize <code>hits = 0</code></li>
<li><strong>for i in 1:N</strong></li>
<li>Generate two random numbers, <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span>, between 0 and 1</li>
<li>If <span class="math inline">\(U_1^2 + U_2^2 &lt; 1\)</span>, then <code>hits = hits + 1</code></li>
<li><strong>end for</strong></li>
<li>Area estimate = <code>hits / N</code></li>
<li><span class="math inline">\(\hat{pi} = 4 * Area Estimate\)</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi_naive &lt;-<span class="st"> </span><span class="cf">function</span>(N) {
  hits &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(N)) {
    U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
    U2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
    <span class="cf">if</span> ((U1<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>U2<span class="op">^</span><span class="dv">2</span>) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) {
      hits &lt;-<span class="st"> </span>hits <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
  }
  
  <span class="dv">4</span><span class="op">*</span>hits<span class="op">/</span>N
}
N &lt;-<span class="st"> </span><span class="fl">1e6</span>
(t1 &lt;-<span class="st"> </span><span class="kw">system.time</span>(pi_est_naive &lt;-<span class="st"> </span><span class="kw">pi_naive</span>(N)))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    3.79    0.00    3.84</span>
pi_est_naive
<span class="co">#&gt; [1] 3.14</span></code></pre></div>
<p>That’s a long run time (and bad estimate). Let’s vectorize it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi_vect &lt;-<span class="st"> </span><span class="cf">function</span>(N) {
  U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  U2 &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  hits &lt;-<span class="st"> </span><span class="kw">sum</span>(U1<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>U2<span class="op">^</span><span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)
  <span class="dv">4</span><span class="op">*</span>hits<span class="op">/</span>N
}
(t2 &lt;-<span class="st"> </span><span class="kw">system.time</span>(pi_est_vect &lt;-<span class="st"> </span><span class="kw">pi_vect</span>(N)))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.07    0.01    0.09</span>
pi_est_vect
<span class="co">#&gt; [1] 3.14</span></code></pre></div>
<p>The speed up from vectorization is impressive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">floor</span>(t1<span class="op">/</span>t2)
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;      54       0      42</span></code></pre></div>
</div>
</div>
<div id="reading-for-next-class-1" class="section level2">
<h2><span class="header-section-number">3.8</span> Reading For Next Class</h2>
<ol style="list-style-type: decimal">
<li>Read the chapter on <a href="http://r4ds.had.co.nz/tibbles.html">Tibbles</a></li>
<li>Try the exercises at the end of the chapter.
<ul>
<li>Problem 2: Create a tibble (or convert the data frame) and compare. Also compare <code>str</code> or <code>glimpse</code> on the objects.</li>
<li>Problem 3: Try to extract the column “mpg” from the mtcars data frame (convert to a tibble and compare) using <code>var &lt;- &quot;mpg&quot;</code>. This illustrates a common source of confusion for people coming from SAS.</li>
<li>Problem 4: non-syntactic names usually occur when importing data from various file types. Knowing how to use / correct them is very useful. Don’t worry about creating the plot.</li>
</ul></li>
</ol>
</div>
<div id="exercises-1" class="section level2">
<h2><span class="header-section-number">3.9</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Browse this <a href="http://adv-r.had.co.nz/Vocabulary.html">vocabulary list</a> and read the help file for functions that interest you.</li>
<li>Re-run the three cases in the For loop section with <code>x &lt;- NULL</code></li>
<li>Vectorization / function practice.</li>
</ol>
<p>We’ll calculate pi using the Gregory-Leibniz series. Mathematicians will be quick to point out that this is a poor way to calculate pi, since the series converges very slowly. But our goal is not calculating pi, our goal is examining the performance benefit that be be achieved using vectorization.</p>
<p>Here is a formula for the Gregory-Leibniz series:</p>
<span class="math display">\[\begin{equation}
1 - \frac{1}{3} + \frac{1}{5} - \frac{1}{7} + \frac{1}{9} - \frac{1}{11} + \cdots = \frac{\pi}{4}
\end{equation}\]</span>
<p>Here is the Gregory-Leibniz series in summation notation:</p>
<span class="math display">\[\begin{equation}
\sum_{\text{n}=0}^{\infty} \frac{(-1)^n}{2\cdot n + 1} = \frac{\pi}{4}
\end{equation}\]</span>
<p>The straightforward implementation using an R loop would look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GL_naive &lt;-<span class="st"> </span><span class="cf">function</span> (limit) {
  p &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>limit) {
    p &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>n<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>p
    }
  <span class="dv">4</span><span class="op">*</span>p
}

N &lt;-<span class="st"> </span><span class="fl">1e7</span>
<span class="kw">system.time</span>(pi_est &lt;-<span class="st"> </span><span class="kw">GL_naive</span>(N))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    2.27    0.02    2.29</span>
pi_est
<span class="co">#&gt; [1] 3.14</span></code></pre></div>
<p>Your task is to vectorize this function. Do not use any looping or apply functions. This one is a bit tricky. Hint: It may be easier to think about it in terms of the series notation and not the summation notation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GL_vect &lt;-<span class="st"> </span><span class="cf">function</span>(limit) {
  <span class="co"># your code here</span>
  <span class="co"># use only base functions and no looping mechanisms</span>
}</code></pre></div>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Technically speaking functions and environments are objects which allows one to do things in R you can’t do in many other languages.<a href="baser-rbasics.html#fnref2">↩</a></p></li>
<li id="fn3"><p>Surprisingly, what constitutes a letter is determined by your current locale. That means that the syntax of R code actually differs from computer to computer, and it’s possible for a file that works on one computer to not even parse on another!<a href="baser-rbasics.html#fnref3">↩</a></p></li>
<li id="fn4"><p><code>is.numeric()</code> is a general test for the “numberliness” of a vector and returns TRUE for both integer and double vectors. It is not a specific test for double vectors, which are often called numeric.<a href="baser-rbasics.html#fnref4">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="good-practices.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-import.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/DavisBrian/corporater/edit/master/rbasics.Rmd",
"text": "Edit"
},
"download": ["rclassnotes.pdf", "rclassnotes.epub"],
"toc": {
"collapse": "section"
},
"css": "corp.css"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
